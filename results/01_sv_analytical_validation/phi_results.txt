Matrix-Valued Shapley Attribution — Quadratic Model

Shapley attribution matrix Φ (single sample)
[[-0.19482535  1.297373    0.         -0.36635852  0.        ]
 [ 1.297373    1.873553    0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.        ]
 [-0.36635852  0.          0.         -0.4965222   0.        ]
 [ 0.          0.          0.          0.         -0.16974208]]

Mean Shapley attribution matrix Φ (50 samples)
[[ 0.02289357  0.11187336  0.          0.00073814  0.        ]
 [ 0.11187335  0.16463536  0.          0.          0.        ]
 [ 0.          0.          0.          0.          0.        ]
 [ 0.00073814  0.          0.          0.0011874   0.        ]
 [ 0.          0.          0.          0.         -0.07660972]]

Analytical vs Numeric Φ (single sample)
i  j   numeric_phi   analytical_phi   abs_error
0  0  -0.194825    -0.194825    1.49e-08
0  1   1.297373     1.297373    0.00e+00
0  2   0.000000     0.000000    0.00e+00
0  3  -0.366359    -0.366359    2.98e-08
0  4   0.000000    -0.000000    0.00e+00
1  0   1.297373     1.297373    0.00e+00
1  1   1.873553     1.873553    1.19e-07
1  2   0.000000     0.000000    0.00e+00
1  3   0.000000     0.000000    0.00e+00
1  4   0.000000    -0.000000    0.00e+00
2  0   0.000000     0.000000    0.00e+00
2  1   0.000000     0.000000    0.00e+00
2  2   0.000000    -0.000000    0.00e+00
2  3   0.000000     0.000000    0.00e+00
2  4   0.000000    -0.000000    0.00e+00
3  0  -0.366359    -0.366359    2.98e-08
3  1   0.000000     0.000000    0.00e+00
3  2   0.000000     0.000000    0.00e+00
3  3  -0.496522    -0.496522    2.98e-08
3  4   0.000000    -0.000000    0.00e+00
4  0   0.000000    -0.000000    0.00e+00
4  1   0.000000    -0.000000    0.00e+00
4  2   0.000000    -0.000000    0.00e+00
4  3   0.000000    -0.000000    0.00e+00
4  4  -0.169742    -0.169742    0.00e+00

Exact Recovery Validation (50 random inputs)
Global max |Φ_num − Φ_ana|:        2.38e-07
Diagonal max error:               2.38e-07
Off-diagonal max error:           1.19e-07
Max Frobenius norm deviation:     2.40e-07
